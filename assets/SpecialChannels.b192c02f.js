import{_ as T,a as I,B,G as F,E as w,D as h,H as l,I as M,r as Y,A as R,C as V,Q as A}from"./index.a7ab16d8.js";import{R as k,P as d,Q,d as i,T as L}from"./YoutubeDataService.7b7c89c2.js";import{Q as q,a as $,u as O}from"./QTable.5035bb06.js";const E={props:{rawSeries:{required:!0,type:Object}},setup(c){const f={rowsPerPage:100,sortBy:"share",descending:!0},m=[{name:"icon",label:"Icon",sortable:!1},{name:"currentViews",label:"Current Period Views",field:"currentViews",sortable:!0,align:"right",format:(t,e)=>t.toLocaleString(),sort:(t,e,a,o)=>parseInt(t,10)-parseInt(e,10)},{name:"viewsDelta",label:"Views Delta",field:"viewsDelta",sortable:!0,align:"right",format:(t,e)=>t.toLocaleString(),sort:(t,e,a,o)=>parseInt(t,10)-parseInt(e,10)},{name:"subscribers",label:"Current Period Subscribers",field:"currentSubscribers",sortable:!0,align:"right",format:(t,e)=>t.toLocaleString(),sort:(t,e,a,o)=>parseInt(t,10)-parseInt(e,10)},{name:"subscribersDelta",label:"Subscribers Delta",field:"subscribersDelta",sortable:!0,align:"right",format:(t,e)=>t.toLocaleString(),sort:(t,e,a,o)=>parseInt(t,10)-parseInt(e,10)},{name:"share",label:"Share",field:"currentShare",sortable:!0,align:"right",format:(t,e)=>t.toLocaleString()+"%",sort:(t,e,a,o)=>parseFloat(t,10)-parseFloat(e,10)},{name:"shareDelta",label:"Share Delta",field:"shareDelta",sortable:!0,align:"right",format:(t,e)=>t.toLocaleString(),sort:(t,e,a,o)=>parseFloat(t,10)-parseFloat(e,10)},{name:"name",label:"Name",field:"name",sortable:!0,align:"left"}],r=I(()=>{const t=[];return c.rawSeries.forEach(e=>{t.push({name:e.name,currentViews:e.currentViews,viewsDelta:e.currentViews-e.previousViews,currentSubscribers:e.currentSubscribers,subscribersDelta:e.currentSubscribers-e.previousSubscribers,currentShare:e.currentShare,shareDelta:e.currentShare-e.previousShare,id:e.id})}),t});return{columns:m,rows:r,pagination:f}}},N={class:""},j=["href"],G=["src"],H=["href"];function W(c,f,m,r,t,e){return B(),F("div",N,[w($,{title:"Special Channels",rows:r.rows,columns:r.columns,pagination:r.pagination,"row-key":"name",class:"sticky-header-table","binary-state-sort":""},{"body-cell-icon":h(a=>[w(q,{props:a,"auto-width":""},{default:h(()=>[l("div",null,[l("a",{href:"./#/channel-details/"+a.row.id},[l("img",{src:"./channel-icons/"+a.row.id+".jpg",style:{width:"40px"}},null,8,G)],8,j)])]),_:2},1032,["props"])]),"body-cell-name":h(a=>[w(q,{props:a},{default:h(()=>[l("div",null,[l("a",{href:"./#/channel-details/"+a.row.id},M(a.row.name),9,H)])]),_:2},1032,["props"])]),_:1},8,["rows","columns","pagination"])])}var z=T(E,[["render",W]]);const{subtractFromDate:J,formatDate:p}=i,K={components:{ReportPeriodSelector:k,TableOfSpecialChannels:z},setup(){const c=new L,f=Y([]),m=Y([]),r=Date.now(),t=J(r,{days:7});var e=p(r,"MMM DD, YYYY"),a=p(t,"MMM DD, YYYY");const o=Y({from:a,to:e}),b=d.getItem("dateSelection");b!=null&&b.saved>=r-60*60*24*1e3&&(a=p(b.from,"MMM DD, YYYY"),e=p(b.to,"MMM DD, YYYY"),o.value={from:a,to:e});const x=d.getItem("password"),C=s=>{o.value.from=p(s.from,"MMM DD, YYYY"),o.value.to=p(s.to,"MMM DD, YYYY");const n=i.extractDate(s.from,"YYYY/MM/DD"),u=i.extractDate(s.to,"YYYY/MM/DD"),_=Date.now(),g={from:n.getTime(),to:u.getTime(),saved:_};d.set("dateSelection",g),y()},D=s=>{y()},y=()=>{try{const s="MMM DD, YYYY",n=i.extractDate(o.value.from,s),u=i.addToDate(i.extractDate(o.value.to,s),{days:1}),_=i.getDateDiff(u,n,"days"),g=i.subtractFromDate(n,{days:_}).getTime()/1e3,S=n.getTime()/1e3,P=S,v=u.getTime()/1e3;c.createFilteredData([],g,v),f.value=c.getBasicStatsForPeriod(S,v),m.value=c.getSpecialChannelData(S,v,g,P)}catch(s){console.log(s),console.log(s.stack)}};if(x==null)O().dialog({title:"Prompt",message:"Password?",prompt:{model:"",type:"password"},cancel:!0,persistent:!0}).onOk(n=>{c.loadDatabase(n).then(u=>{u?(d.set("password",n),D()):d.remove("password")})});else{const s=d.getItem("password");c.loadDatabase(s).then(n=>{n?D():d.remove("password")})}return{dateRange:o,handleReportRequested:C,handleDatabaseLoaded:D,specialChannelData:m}}},U={class:"col-xs-12 col-sm-12 col-md-12"},X={class:"row q-mt-md text-h5"},Z={class:"row q-mt-md q-gutter-sm"},ee={class:"row q-col-gutter-md q-mt-md q-mr-md q-ml-md"},te={class:"col-xs-12 col-sm-12 col-md-12 col-lg-12"};function ae(c,f,m,r,t,e){const a=R("ReportPeriodSelector"),o=R("TableOfSpecialChannels");return B(),V(Q,{class:"row q-pl-md q-pr-md q-pb-lg"},{default:h(()=>[l("div",U,[l("div",X," Youtube Statistics for "+M(r.dateRange.from)+" to "+M(r.dateRange.to),1),l("div",Z,[w(a,{from:r.dateRange.from,to:r.dateRange.to,onReportRequested:r.handleReportRequested},null,8,["from","to","onReportRequested"]),w(A,{type:"a",href:"./#/",label:"< Main Report",push:""})]),l("div",ee,[l("div",te,[w(o,{"raw-series":r.specialChannelData},null,8,["raw-series"])])])])]),_:1})}var ne=T(K,[["render",ae]]);export{ne as default};
