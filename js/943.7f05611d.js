"use strict";(self["webpackChunkyt_stats_quasar"]=self["webpackChunkyt_stats_quasar"]||[]).push([[943],{3308:(e,t,a)=>{a.d(t,{Z:()=>c});a(71),a(7098),a(9377),a(7664);var s=a(6395),n=a(5616),r=a(52),o=a.n(r);class c{constructor(){}static get unngroupedGroupingName(){return"[Ungrouped]"}async _fetchMetadata(){var e=await o().get("./data/metadata.json");return Promise.resolve(e.data)}async _fetchViewsData(e,t,a){const s=n.ZP.extractDate(e,"YYYY/MM/DD"),r=n.ZP.extractDate(t,"YYYY/MM/DD"),c=a["viewDeltaFiles"],i={},l=[],u={inclusiveFrom:!0,inclusiveTo:!0};c.forEach((e=>{const t=n.ZP.extractDate(e["start"],"MMMM_DD_YYYY"),a=n.ZP.extractDate(e["end"],"MMMM_DD_YYYY");t<=r&&s<=a&&l.push(o().get("./data/"+e["fileName"]))}));const d=await Promise.all(l);return d.forEach((e=>{Object.keys(e.data).forEach((t=>{const a=n.ZP.extractDate(t,"MMMM_DD_YYYY");n.ZP.isBetweenDates(a,s,r,u)&&(i[t]=e.data[t])}))})),i}async _fetchSubscriberCounts(e,t,a){const s=n.ZP.extractDate(e,"YYYY/MM/DD"),r=n.ZP.extractDate(t,"YYYY/MM/DD"),c=(await this.getChannels(),a["subscriberCountsFiles"]),i={},l=[],u={inclusiveFrom:!0,inclusiveTo:!0};c.forEach((e=>{const t=n.ZP.extractDate(e["start"],"MMMM_DD_YYYY"),a=n.ZP.extractDate(e["end"],"MMMM_DD_YYYY");t<=r&&s<=a&&l.push(o().get("./data/"+e["fileName"]))}));const d=await Promise.all(l);return d.forEach((e=>{Object.keys(e.data).forEach((t=>{const a=n.ZP.extractDate(t,"MMMM_DD_YYYY");n.ZP.isBetweenDates(a,s,r,u)&&(i[t]=e.data[t])}))})),i}async fetchChannelData(e,t,a){const s=await this._fetchMetadata(),r=s["channels"][a],o=await this._fetchViewsData(e,t,s),c=await this._fetchSubscriberCounts(e,t,s),i=Object.keys(o),l=[],u=[],d=[],p=[0,0,0,0,0,0,0];i.forEach((e=>{const t=o[e],s=c[e],r=n.ZP.extractDate(e,"MMMM_DD_YYYY").getTime(),i=n.ZP.extractDate(e,"MMMM_DD_YYYY").getDay(),h=Object.values(t).reduce(((e,t)=>t+e),0);if(t.hasOwnProperty(a)){l.push([r,t[a]]),p[i]+=t[a];const e=(100*t[a]/h).toFixed(1);d.push([r,e])}else l.push([r,0]),d.push([r,0]);s.hasOwnProperty(a)?u.push([r,s[a]]):u.push([r,0])}));const h={viewsByDay:{name:"",data:l},subscribersByDay:{name:"",data:u},viewsByDayOfWeek:{name:"",data:p},shareByDay:{name:"",data:d},channelData:r};return Promise.resolve(h)}async fetchData(e,t){const a=await this._fetchMetadata(),s=await this._fetchViewsData(e,t,a),n=await this._fetchSubscriberCounts(e,t,a),r=await this.getChannels(),o=await this._calculateTotalViewsAndSubscribersByChannel(s,n,r),c=await this.getChannelGroupings(),i=this._getChannelIdToGroupingMap(c),l=this._calculateViewsByGrouping(s,c,i),u=this._calculateViewsByDayAndGrouping(s,c,i),d=this._calculateViewsByDayOfWeekAndGrouping(s,c,i),p=this._calculateViewsByChannelAndCollectByGrouping(s,c,l),h=this._calculateViewsByDayAndChannel(s,c),m={viewsByGrouping:l,viewsByDayAndGrouping:u,viewsByDayOfWeekAndGrouping:d,viewsByChannelCollectedByGrouping:p,viewsByDayAndChannel:h,subscriberCounts:n,viewsAndSubscribersTotals:o};return Promise.resolve(m)}_calculateViewsByDayAndGrouping(e,t,a){const s=Object.keys(e),r=[];return Object.keys(t).forEach((t=>{const o=[];s.forEach((s=>{const r=e[s],c=n.ZP.extractDate(s,"MMMM_DD_YYYY").getTime();var i=0;for(const[e,n]of Object.entries(r))a[e]===t&&(i+=n);o.push([c,i])})),r.push({name:t,data:o})})),r}_calculateViewsByDayOfWeekAndGrouping(e,t,a){const s=Object.keys(e),r={};return Object.keys(t).forEach((e=>{r[e]={name:e,data:[0,0,0,0,0,0,0]}})),s.forEach((t=>{const s=n.ZP.extractDate(t,"MMMM_DD_YYYY").getDay(),o=e[t];for(const[e,n]of Object.entries(o)){const t=a[e];r[t].data[s]+=n}})),Object.values(r)}_calculateViewsByGrouping(e,t,a){const s={};Object.keys(t).forEach((e=>{s[e]=0}));for(const[n,r]of Object.entries(e))for(const[e,t]of Object.entries(r)){const n=a[e];s[n]+=t}return s}_calculateTotalViewsAndSubscribersByChannel(e,t,a){const s=a.map((e=>e.id)),n=Object.keys(e);var r=0;const o={},c={};s.forEach((e=>{o[e]=[],c[e]=[]}));const i={};a.forEach((e=>{i[e.id]=e})),n.forEach((a=>{Object.entries(e[a]).forEach((e=>{o[e[0]].push(e[1]),r+=e[1]})),Object.entries(t[a]).forEach((e=>{c[e[0]].push(e[1])}))}));const l=[];return Object.keys(o).forEach((e=>{const t=o[e],a=c[e],s=t.reduce(((e,t)=>e+t),0),n=a.reduce(((e,t)=>e+t),0),u=n/a.length,d={name:i[e]["name"],id:parseInt(e),share:parseFloat((100*s/r).toFixed(1)),subscribers:parseFloat(u.toFixed(0)),views:s,data:[[u,s]]};l.push(d)})),l.sort(((e,t)=>t.data[0][0]<e.data[0][0]?-1:t.data[0][0]>e.data[0][0]?1:0)),l}_calculateViewsByDayAndChannel(e,t){const a=Object.keys(e),s=Object.values(t).flat(),r=[];s.forEach((t=>{const s=[];a.forEach((a=>{const r=e[a],o=n.ZP.extractDate(a,"MMMM_DD_YYYY").getTime();r.hasOwnProperty(t.id)?s.push([o,r[t.id]]):s.push([o,0])}));const o=s.reduce(((e,t)=>t[1]+e),0);r.push({name:t.name,data:s,totalViews:o})}));const o=r.reduce(((e,t)=>t.totalViews+e),0),c=r.map((e=>(e["percentageOfTotalViews"]=e.totalViews/o,e)));return c}_calculateViewsByChannelAndCollectByGrouping(e,t,a){const s={};for(const[r,o]of Object.entries(t))o.forEach((e=>{s[e.id]=0}));for(const[r,o]of Object.entries(e))for(const[e,t]of Object.entries(o))s[e]+=t;const n=[];for(const[r,o]of Object.entries(t)){const e=[];o.forEach((t=>{e.push({x:t.name,y:s[t.id],url:t.url,id:t.id,shareOfGrouping:(100*s[t.id]/a[r]).toFixed(1)})})),n.push({name:r,data:e})}return n}_getChannelIdToGroupingMap(e){const t={};for(const[a,s]of Object.entries(e))s.forEach((e=>{t[e.id]=a}));return t}saveCustomChannelGroupings(e){const t=Object.keys(e);t.forEach((t=>{0==e[t].length&&delete e[t]})),s.Z.set("customChannelGroupings",e)}getCustomChannelGroupings(){return s.Z.getItem("customChannelGroupings")}async getChannels(){const e=await o().get("./data/metadata.json");return Promise.resolve(Object.values(e.data["channels"]))}async getDefaultChannelGroupings(){const e=await o().get("./data/default-channel-groupings.json");return Promise.resolve(e.data)}async getChannelGroupings(){var e=await this.getDefaultChannelGroupings(),t=this.getCustomChannelGroupings();if(null===t)return Promise.resolve(e);const a=Object.values(t).flat().map((e=>e.id)),s=Object.values(e).flat().map((e=>e.id));if(a.length==s.length)return Promise.resolve(t);const n=s.filter((e=>!a.includes(e))),r=c.unngroupedGroupingName;t.hasOwnProperty(r)||(t[r]=[]);const o=Object.values(e).flat(),i=o.filter((e=>n.includes(e.id)));t[r]=t[r].concat(i);const l=Object.keys(t);return l.forEach((e=>{0==t[e].length&&delete t[e]})),this.saveCustomChannelGroupings(t),Promise.resolve(t)}}},1518:(e,t,a)=>{a.d(t,{Z:()=>p});var s=a(3673);function n(e,t,a,n,r,o){const c=(0,s.up)("q-date"),i=(0,s.up)("q-popup-proxy"),l=(0,s.up)("q-btn");return(0,s.wg)(),(0,s.j4)(l,{icon:"event",color:"primary",label:"Select Report Period",push:""},{default:(0,s.w5)((()=>[(0,s.Wm)(i,{"transition-show":"scale","transition-hide":"scale"},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{modelValue:n.dateRange,"onUpdate:modelValue":t[1]||(t[1]=e=>n.dateRange=e),minimal:"",range:"",square:"",onRangeEnd:n.reportRequested},null,8,["modelValue","onRangeEnd"])])),_:1})])),_:1})}var r=a(1959);const o={props:{from:{required:!0,type:String},to:{required:!0,type:String}},emits:["reportRequested"],setup(e,{emit:t}){const a=(0,r.iH)({from:e.from,to:e.to}),s=e=>{t("reportRequested",a.value)};return{reportRequested:s,dateRange:a}}};var c=a(4607),i=a(3944),l=a(1860),u=a(7518),d=a.n(u);o.render=n;const p=o;d()(o,"components",{QBtn:c.Z,QPopupProxy:i.Z,QDate:l.Z})},5943:(e,t,a)=>{a.r(t),a.d(t,{default:()=>ee});var s=a(3673),n=a(2323);const r={class:"col-xs-12 col-sm-12 col-md-12"},o={class:"row q-mt-md text-h5"},c={class:"row q-mt-md q-gutter-sm"},i={class:"row q-col-gutter-md q-mt-md q-mr-md q-ml-md"},l={class:"fit"},u={class:"text-h6"},d={class:"text-subtitle2"},p=(0,s.Uk)(" lorem ipsum "),h={class:"col-xs-12 col-sm-12 col-md-6 col-lg-6"},m={class:"col-xs-12 col-sm-12 col-md-6 col-lg-6"},y={class:"col-xs-12 col-sm-12 col-md-6 col-lg-6"},f={class:"col-xs-12 col-sm-12 col-md-6 col-lg-6"};function D(e,t,a,D,g,w){const Y=(0,s.up)("ReportPeriodSelector"),b=(0,s.up)("q-btn"),M=(0,s.up)("q-item-section"),v=(0,s.up)("q-item"),_=(0,s.up)("q-separator"),C=(0,s.up)("q-card-section"),O=(0,s.up)("q-card"),q=(0,s.up)("ChartOfSingleChannelViewsByDay"),x=(0,s.up)("ChartOfSingleChannelSubscribersByDay"),W=(0,s.up)("ChartOfSingleChannelViewsByDayOfWeek"),B=(0,s.up)("ChartOfSingleChannelShareByDay"),j=(0,s.up)("q-page");return(0,s.wg)(),(0,s.j4)(j,{class:"row q-pl-md q-pr-md q-pb-lg"},{default:(0,s.w5)((()=>[(0,s.Wm)("div",r,[(0,s.Wm)("div",o," Single Channel Statistics for "+(0,n.zw)(D.dateRange.from)+" to "+(0,n.zw)(D.dateRange.to),1),(0,s.Wm)("div",c,[(0,s.Wm)(Y,{from:D.dateRange.from,to:D.dateRange.to,onReportRequested:D.handleReportRequested},null,8,["from","to","onReportRequested"]),(0,s.Wm)(b,{type:"a",href:"/#/",label:"< Main Report",push:""})]),(0,s.Wm)("div",i,[(0,s.Wm)("div",l,[(0,s.Wm)(O,{class:"fit q-pl-sm q-pr-sm q-pt-sm"},{default:(0,s.w5)((()=>[(0,s.Wm)(v,null,{default:(0,s.w5)((()=>[(0,s.Wm)(M,{avatar:""},{default:(0,s.w5)((()=>[(0,s.Wm)("img",{src:"./channel-icons/"+e.$route.params.channelId+".jpg"},null,8,["src"])])),_:1}),(0,s.Wm)(M,null,{default:(0,s.w5)((()=>[(0,s.Wm)("div",u,(0,n.zw)(D.channelData.name),1),(0,s.Wm)("div",d,[(0,s.Wm)("a",{href:D.channelData.url},"View on Youtube",8,["href"])])])),_:1})])),_:1}),(0,s.Wm)(_),(0,s.Wm)(C,{class:"q-pt-none"},{default:(0,s.w5)((()=>[p])),_:1})])),_:1})]),(0,s.Wm)("div",h,[(0,s.Wm)(O,{class:"fit q-pl-sm q-pr-sm q-pt-sm"},{default:(0,s.w5)((()=>[(0,s.Wm)(q,{series:D.viewsByDay},null,8,["series"])])),_:1})]),(0,s.Wm)("div",m,[(0,s.Wm)(O,{class:"fit q-pl-sm q-pr-sm q-pt-sm"},{default:(0,s.w5)((()=>[(0,s.Wm)(x,{series:D.subscribersByDay},null,8,["series"])])),_:1})]),(0,s.Wm)("div",y,[(0,s.Wm)(O,{class:"fit q-pl-sm q-pr-sm q-pt-sm"},{default:(0,s.w5)((()=>[(0,s.Wm)(W,{series:D.viewsByDayOfWeek},null,8,["series"])])),_:1})]),(0,s.Wm)("div",f,[(0,s.Wm)(O,{class:"fit q-pl-sm q-pr-sm q-pt-sm"},{default:(0,s.w5)((()=>[(0,s.Wm)(B,{series:D.shareByDay},null,8,["series"])])),_:1})])])])])),_:1})}var g=a(1959),w=a(5616),Y=a(9582),b=a(6395),M=a(1518),v=a(3308);const _=(0,s.Wm)("div",{class:"text-h6"},"Views by Day",-1);function C(e,t,a,n,r,o){const c=(0,s.up)("apexchart");return(0,s.wg)(),(0,s.j4)("div",null,[_,(0,s.Wm)(c,{type:"line",series:a.series,options:n.options},null,8,["series","options"])])}var O=a(2585),q=a.n(O);const x={components:{apexchart:q()},props:{series:{required:!0,type:Object}},setup(e){const t={chart:{stacked:!1,toolbar:{show:!0},zoom:{enabled:!0}},xaxis:{type:"datetime"},dataLabels:{enabled:!1},stroke:{width:2},tooltip:{enabled:!1}};return{options:t}}};x.render=C;const W=x,B=(0,s.Wm)("div",{class:"text-h6"},"Views by Day of Week",-1);function j(e,t,a,n,r,o){const c=(0,s.up)("apexchart");return(0,s.wg)(),(0,s.j4)("div",null,[B,(0,s.Wm)(c,{type:"bar",options:n.options,series:a.series},null,8,["options","series"])])}const P={components:{apexchart:q()},props:{series:{required:!0,type:Object}},setup(e){const t={chart:{type:"bar",stacked:!0,toolbar:{show:!0},zoom:{enabled:!1}},xaxis:{categories:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]}};return{options:t}}};P.render=j;const Z=P,k=(0,s.Wm)("div",{class:"text-h6"},"Subscribers by Day",-1);function S(e,t,a,n,r,o){const c=(0,s.up)("apexchart");return(0,s.wg)(),(0,s.j4)("div",null,[k,(0,s.Wm)(c,{type:"line",series:a.series,options:n.options},null,8,["series","options"])])}const V={components:{apexchart:q()},props:{series:{required:!0,type:Object}},setup(e){const t={chart:{stacked:!1,toolbar:{show:!0},zoom:{enabled:!0}},xaxis:{type:"datetime"},dataLabels:{enabled:!1},stroke:{width:2},tooltip:{enabled:!1}};return{options:t}}};V.render=S;const E=V,G=(0,s.Wm)("div",{class:"text-h6"},"Share by Day",-1);function R(e,t,a,n,r,o){const c=(0,s.up)("apexchart");return(0,s.wg)(),(0,s.j4)("div",null,[G,(0,s.Wm)(c,{type:"line",series:a.series,options:n.options},null,8,["series","options"])])}const T={components:{apexchart:q()},props:{series:{required:!0,type:Object}},setup(e){const t={chart:{stacked:!1,toolbar:{show:!0},zoom:{enabled:!0}},xaxis:{type:"datetime"},dataLabels:{enabled:!1},stroke:{width:2},tooltip:{enabled:!1}};return{options:t}}};T.render=R;const A=T,{subtractFromDate:F,formatDate:I}=w.ZP,Q={components:{ReportPeriodSelector:M.Z,ChartOfSingleChannelViewsByDay:W,ChartOfSingleChannelSubscribersByDay:E,ChartOfSingleChannelViewsByDayOfWeek:Z,ChartOfSingleChannelShareByDay:A},setup(){const e=(0,Y.yj)(),t=new v.Z,a=(0,g.iH)([]),s=(0,g.iH)([]),n=(0,g.iH)([]),r=(0,g.iH)([]),o=(0,g.iH)({name:"",url:""}),c=Date.now(),i=F(c,{days:7});var l=I(c,"MMM DD, YYYY"),u=I(i,"MMM DD, YYYY");const d=(0,g.iH)({from:u,to:l}),p=b.Z.getItem("dateSelection");null!=p&&p["saved"]>=c-864e5&&(u=I(p["from"],"MMM DD, YYYY"),l=I(p["to"],"MMM DD, YYYY"),d.value={from:u,to:l});const h=e=>{a.value=[e.viewsByDay],s.value=[e.subscribersByDay],n.value=[e.viewsByDayOfWeek],o.value=e.channelData,r.value=[e.shareByDay],console.log(e)},m=a=>{d.value.from=I(a.from,"MMM DD, YYYY"),d.value.to=I(a.to,"MMM DD, YYYY"),console.log("saving",a.from,a.to);const s=w.ZP.extractDate(a.from,"YYYY/MM/DD"),n=w.ZP.extractDate(a.to,"YYYY/MM/DD"),r=Date.now(),o={from:s.getTime(),to:n.getTime(),saved:r};b.Z.set("dateSelection",o),t.fetchChannelData(a.from,a.to,e.params.channelId).then((e=>{h(e)}))};return t.fetchChannelData(I(u,"YYYY/MM/DD"),I(l,"YYYY/MM/DD"),e.params.channelId).then((e=>{h(e)})),{dateRange:d,handleReportRequested:m,viewsByDay:a,subscribersByDay:s,viewsByDayOfWeek:n,channelData:o,shareByDay:r}}};var z=a(4379),H=a(4607),N=a(151),L=a(3414),U=a(2035),$=a(5869),J=a(5589),K=a(7518),X=a.n(K);Q.render=D;const ee=Q;X()(Q,"components",{QPage:z.Z,QBtn:H.Z,QCard:N.Z,QItem:L.Z,QItemSection:U.Z,QSeparator:$.Z,QCardSection:J.Z})}}]);