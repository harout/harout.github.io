"use strict";(self["webpackChunkyt_stats_quasar"]=self["webpackChunkyt_stats_quasar"]||[]).push([[740],{3308:(e,t,n)=>{n.d(t,{Z:()=>c});n(71),n(7098),n(9377),n(7664);var a=n(6395),s=n(2661),r=n(52),o=n.n(r);class c{constructor(){}static get unngroupedGroupingName(){return"[Ungrouped]"}async _fetchMetadata(){var e=await o().get("./data/metadata.json");return Promise.resolve(e.data)}async _fetchViewsData(e,t,n){const a=s.ZP.extractDate(e,"YYYY/MM/DD"),r=s.ZP.extractDate(t,"YYYY/MM/DD"),c=n["viewDeltaFiles"],i={},l=[],u={inclusiveFrom:!0,inclusiveTo:!0};c.forEach((e=>{const t=s.ZP.extractDate(e["start"],"MMMM_DD_YYYY"),n=s.ZP.extractDate(e["end"],"MMMM_DD_YYYY");t<=r&&a<=n&&l.push(o().get("./data/"+e["fileName"]))}));const h=await Promise.all(l);return h.forEach((e=>{Object.keys(e.data).forEach((t=>{const n=s.ZP.extractDate(t,"MMMM_DD_YYYY");s.ZP.isBetweenDates(n,a,r,u)&&(i[t]=e.data[t])}))})),i}async _fetchSubscriberCounts(e,t,n){const a=s.ZP.extractDate(e,"YYYY/MM/DD"),r=s.ZP.extractDate(t,"YYYY/MM/DD"),c=(await this.getChannels(),n["subscriberCountsFiles"]),i={},l=[],u={inclusiveFrom:!0,inclusiveTo:!0};c.forEach((e=>{const t=s.ZP.extractDate(e["start"],"MMMM_DD_YYYY"),n=s.ZP.extractDate(e["end"],"MMMM_DD_YYYY");t<=r&&a<=n&&l.push(o().get("./data/"+e["fileName"]))}));const h=await Promise.all(l);return h.forEach((e=>{Object.keys(e.data).forEach((t=>{const n=s.ZP.extractDate(t,"MMMM_DD_YYYY");s.ZP.isBetweenDates(n,a,r,u)&&(i[t]=e.data[t])}))})),i}async fetchData(e,t){const n=await this._fetchMetadata(),a=await this._fetchViewsData(e,t,n),s=await this._fetchSubscriberCounts(e,t,n),r=await this.getChannels(),o=await this._calculateTotalViewsAndSubscribersByChannel(a,s,r),c=await this.getChannelGroupings(),i=this._getChannelIdToGroupingMap(c),l=this._calculateViewsByGrouping(a,c,i),u=this._calculateViewsByDayAndGrouping(a,c,i),h=this._calculateViewsByDayOfWeekAndGrouping(a,c,i),d=this._calculateViewsByChannelAndCollectByGrouping(a,c,l),g=this._calculateViewsByDayAndChannel(a,c),p={viewsByGrouping:l,viewsByDayAndGrouping:u,viewsByDayOfWeekAndGrouping:h,viewsByChannelCollectedByGrouping:d,viewsByDayAndChannel:g,subscriberCounts:s,viewsAndSubscribersTotals:o};return Promise.resolve(p)}_calculateViewsByDayAndGrouping(e,t,n){const a=Object.keys(e),r=[];return Object.keys(t).forEach((t=>{const o=[];a.forEach((a=>{const r=e[a],c=s.ZP.extractDate(a,"MMMM_DD_YYYY").getTime();var i=0;for(const[e,s]of Object.entries(r))n[e]===t&&(i+=s);o.push([c,i])})),r.push({name:t,data:o})})),r}_calculateViewsByDayOfWeekAndGrouping(e,t,n){const a=Object.keys(e),r={};return Object.keys(t).forEach((e=>{r[e]={name:e,data:[0,0,0,0,0,0,0]}})),a.forEach((t=>{const a=s.ZP.extractDate(t,"MMMM_DD_YYYY").getDay(),o=e[t];for(const[e,s]of Object.entries(o)){const t=n[e];r[t].data[a]+=s}})),Object.values(r)}_calculateViewsByGrouping(e,t,n){const a={};Object.keys(t).forEach((e=>{a[e]=0}));for(const[s,r]of Object.entries(e))for(const[e,t]of Object.entries(r)){const s=n[e];a[s]+=t}return a}_calculateTotalViewsAndSubscribersByChannel(e,t,n){const a=n.map((e=>e.id)),s=Object.keys(e),r={},o={};a.forEach((e=>{r[e]=[],o[e]=[]}));const c={};n.forEach((e=>{c[e.id]=e})),s.forEach((n=>{Object.entries(e[n]).forEach((e=>{r[e[0]].push(e[1])})),Object.entries(t[n]).forEach((e=>{o[e[0]].push(e[1])}))}));const i=[];return Object.keys(r).forEach((e=>{const t=r[e],n=o[e],a=t.reduce(((e,t)=>e+t),0),s=n.reduce(((e,t)=>e+t),0);if(s>0){const t={name:c[e]["name"],id:parseInt(e),data:[[s,a]]};i.push(t)}})),i.sort(((e,t)=>t.data[0][0]<e.data[0][0]?-1:t.data[0][0]>e.data[0][0]?1:0)),i}_calculateViewsByDayAndChannel(e,t){const n=Object.keys(e),a=Object.values(t).flat(),r=[];a.forEach((t=>{const a=[];n.forEach((n=>{const r=e[n],o=s.ZP.extractDate(n,"MMMM_DD_YYYY").getTime();r.hasOwnProperty(t.id)?a.push([o,r[t.id]]):a.push([o,0])}));const o=a.reduce(((e,t)=>t[1]+e),0);r.push({name:t.name,data:a,totalViews:o})}));const o=r.reduce(((e,t)=>t.totalViews+e),0),c=r.map((e=>(e["percentageOfTotalViews"]=e.totalViews/o,e)));return c}_calculateViewsByChannelAndCollectByGrouping(e,t,n){const a={};for(const[r,o]of Object.entries(t))o.forEach((e=>{a[e.id]=0}));for(const[r,o]of Object.entries(e))for(const[e,t]of Object.entries(o))a[e]+=t;const s=[];for(const[r,o]of Object.entries(t)){const e=[];o.forEach((t=>{e.push({x:t.name,y:a[t.id],url:t.url,id:t.id,shareOfGrouping:(100*a[t.id]/n[r]).toFixed(1)})})),s.push({name:r,data:e})}return s}_getChannelIdToGroupingMap(e){const t={};for(const[n,a]of Object.entries(e))a.forEach((e=>{t[e.id]=n}));return t}saveCustomChannelGroupings(e){const t=Object.keys(e);t.forEach((t=>{0==e[t].length&&delete e[t]})),a.Z.set("customChannelGroupings",e)}getCustomChannelGroupings(){return a.Z.getItem("customChannelGroupings")}async getChannels(){const e=await o().get("./data/metadata.json");return Promise.resolve(Object.values(e.data["channels"]))}async getDefaultChannelGroupings(){const e=await o().get("./data/default-channel-groupings.json");return Promise.resolve(e.data)}async getChannelGroupings(){var e=await this.getDefaultChannelGroupings(),t=this.getCustomChannelGroupings();if(null===t)return Promise.resolve(e);const n=Object.values(t).flat().map((e=>e.id)),a=Object.values(e).flat().map((e=>e.id));if(n.length==a.length)return Promise.resolve(t);const s=a.filter((e=>!n.includes(e))),r=c.unngroupedGroupingName;t.hasOwnProperty(r)||(t[r]=[]);const o=Object.values(e).flat(),i=o.filter((e=>s.includes(e.id)));t[r]=t[r].concat(i);const l=Object.keys(t);return l.forEach((e=>{0==t[e].length&&delete t[e]})),this.saveCustomChannelGroupings(t),Promise.resolve(t)}}},6740:(e,t,n)=>{n.r(t),n.d(t,{default:()=>k});var a=n(3673),s=n(2323);const r=(0,a.HX)("data-v-d023ed74");(0,a.dD)("data-v-d023ed74");const o={class:"row q-ml-sm"},c={class:"list-group-item"},i={class:"row q-ml-sm q-mt-md"},l={class:"col-xs-12 col-sm-12 col-md-12"},u={class:"row items-center justify-center full-height full-width text-center"},h={class:"row q-ml-sm q-mt-xl q-mb-xl"},d={class:"col-xs-6 col-sm-6 col-md-6"},g={class:"row items-center justify-center full-height full-width text-center"},p={class:"col-xs-6 col-sm-6 col-md-6"},m={class:"row items-center justify-center full-height full-width text-center"};(0,a.Cn)();const f=r(((e,t,n,f,v,w)=>{const y=(0,a.up)("ChannelGroupingName"),C=(0,a.up)("draggable"),D=(0,a.up)("q-btn");return(0,a.wg)(),(0,a.j4)(a.HY,null,[(0,a.Wm)("div",o,[((0,a.wg)(!0),(0,a.j4)(a.HY,null,(0,a.Ko)(f.lists,((e,t)=>((0,a.wg)(),(0,a.j4)("div",{key:t,class:"col-xs-12 col-sm-12 col-md-4"},[(0,a.Wm)(y,{"channel-grouping-name":t,onChannelGroupingNameChanged:f.handleChannelGroupingNameChange},null,8,["channel-grouping-name","onChannelGroupingNameChanged"]),(0,a.Wm)(C,{tag:"ul",class:"list-group",list:e,group:"ppl","item-key":"name"},{item:r((({element:e,index:t})=>[(0,a.Wm)("li",c,(0,s.zw)(e.name)+" "+(0,s.zw)(t),1)])),_:2},1032,["list"])])))),128))]),(0,a.Wm)("div",i,[(0,a.Wm)("div",l,[(0,a.Wm)("div",u,[(0,a.Wm)(D,{round:"",color:"primary",icon:"add",onClick:f.addChannelGroup},null,8,["onClick"])])])]),(0,a.Wm)("div",h,[(0,a.Wm)("div",d,[(0,a.Wm)("div",g,[(0,a.Wm)(D,{color:"secondary",icon:"undo",label:"Reset",onClick:f.resetChannelGroupings},null,8,["onClick"])])]),(0,a.Wm)("div",p,[(0,a.Wm)("div",m,[(0,a.Wm)(D,{color:"primary",icon:"done",label:"Done",onClick:f.saveChannelGroupings},null,8,["onClick"])])])])],64)}));var v=n(1959),w=n(9582),y=n(8603),C=n(470),D=n.n(C),G=(n(71),n(8880));function b(e,t,n,r,o,c){return(0,a.wg)(),(0,a.j4)("h5",{contenteditable:"",onBlur:t[1]||(t[1]=(...e)=>r.onEditGroupingName&&r.onEditGroupingName(...e)),onKeydown:t[2]||(t[2]=(0,G.D2)(((...e)=>r.onEditGroupingName&&r.onEditGroupingName(...e)),["enter"]))},(0,s.zw)(r.currentChannelGroupingName),33)}const Y={props:{channelGroupingName:{required:!0,type:String}},emits:["channelGroupingNameChanged"],setup(e,{emit:t}){var n=(0,v.SU)(e.channelGroupingName);const a=function(e){e.preventDefault(),e.target.blur(),t("channelGroupingNameChanged",{previousName:n,newName:e.target.innerHTML}),n=e.target.innerHTML};return{onEditGroupingName:a,currentChannelGroupingName:n}}};Y.render=b;const M=Y;var _=n(3308);const j={display:"Two Lists",order:1,components:{draggable:D(),ChannelGroupingName:M},setup(e,{emit:t}){const n=(0,w.tv)(),a=new _.Z,s=(0,v.iH)([]);a.getChannelGroupings().then((e=>{s.value=e})).catch((e=>console.log("blah blah")));const r=function(e){e.preventDefault();var t=1,n="New Grouping "+String(t);while(1){if(!s.value.hasOwnProperty(n))break;t++,n="New Grouping "+String(t)}s.value[n]=[]},o=function(e){e.preventDefault();JSON.stringify(s.value);a.saveCustomChannelGroupings(s.value),n.push("/")},c=function(e){e.preventDefault(),a.getDefaultChannelGroupings().then((e=>{s.value=e})).then(a.saveCustomChannelGroupings(s.value)).catch((e=>{throw"Error resetting channel groupings."}))},i=function(e){var t=e.newName;if(t!==e.previousName){while(s.value.hasOwnProperty(t)||t===_.Z.unngroupedGroupingName)t+="_";s.value=(0,y.mapKeys)(s.value,(function(n,a){return a===e.previousName?t:a}))}};return{lists:s,addChannelGroup:r,handleChannelGroupingNameChange:i,resetChannelGroupings:c,saveChannelGroupings:o}}};var O=n(6281),E=n(7518),N=n.n(E);j.render=f,j.__scopeId="data-v-d023ed74";const k=j;N()(j,"components",{QBtn:O.Z})}}]);