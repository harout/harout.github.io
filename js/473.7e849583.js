"use strict";(self["webpackChunkyt_stats_quasar"]=self["webpackChunkyt_stats_quasar"]||[]).push([[473],{3308:(e,t,s)=>{s.d(t,{Z:()=>i});s(71),s(7098),s(9377),s(7664);var a=s(6395),n=s(2661),o=s(52),r=s.n(o);class i{constructor(){}static get unngroupedGroupingName(){return"[Ungrouped]"}async _fetchMetadata(){var e=await r().get("./data/metadata.json");return Promise.resolve(e.data)}async _fetchViewsData(e,t,s){const a=n.ZP.extractDate(e,"YYYY/MM/DD"),o=n.ZP.extractDate(t,"YYYY/MM/DD"),i=s["viewDeltaFiles"],c={},l=[],u={inclusiveFrom:!0,inclusiveTo:!0};i.forEach((e=>{const t=n.ZP.extractDate(e["start"],"MMMM_DD_YYYY"),s=n.ZP.extractDate(e["end"],"MMMM_DD_YYYY");t<=o&&a<=s&&l.push(r().get("./data/"+e["fileName"]))}));const d=await Promise.all(l);return d.forEach((e=>{Object.keys(e.data).forEach((t=>{const s=n.ZP.extractDate(t,"MMMM_DD_YYYY");n.ZP.isBetweenDates(s,a,o,u)&&(c[t]=e.data[t])}))})),c}async _fetchSubscriberCounts(e,t,s){const a=n.ZP.extractDate(e,"YYYY/MM/DD"),o=n.ZP.extractDate(t,"YYYY/MM/DD"),i=(await this.getChannels(),s["subscriberCountsFiles"]),c={},l=[],u={inclusiveFrom:!0,inclusiveTo:!0};i.forEach((e=>{const t=n.ZP.extractDate(e["start"],"MMMM_DD_YYYY"),s=n.ZP.extractDate(e["end"],"MMMM_DD_YYYY");t<=o&&a<=s&&l.push(r().get("./data/"+e["fileName"]))}));const d=await Promise.all(l);return d.forEach((e=>{Object.keys(e.data).forEach((t=>{const s=n.ZP.extractDate(t,"MMMM_DD_YYYY");n.ZP.isBetweenDates(s,a,o,u)&&(c[t]=e.data[t])}))})),c}async fetchData(e,t){const s=await this._fetchMetadata(),a=await this._fetchViewsData(e,t,s),n=await this._fetchSubscriberCounts(e,t,s),o=await this.getChannels(),r=await this._calculateTotalViewsAndSubscribersByChannel(a,n,o),i=await this.getChannelGroupings(),c=this._getChannelIdToGroupingMap(i),l=this._calculateViewsByGrouping(a,i,c),u=this._calculateViewsByDayAndGrouping(a,i,c),d=this._calculateViewsByDayOfWeekAndGrouping(a,i,c),p=this._calculateViewsByChannelAndCollectByGrouping(a,i,l),h=this._calculateViewsByDayAndChannel(a,i),m={viewsByGrouping:l,viewsByDayAndGrouping:u,viewsByDayOfWeekAndGrouping:d,viewsByChannelCollectedByGrouping:p,viewsByDayAndChannel:h,subscriberCounts:n,viewsAndSubscribersTotals:r};return Promise.resolve(m)}_calculateViewsByDayAndGrouping(e,t,s){const a=Object.keys(e),o=[];return Object.keys(t).forEach((t=>{const r=[];a.forEach((a=>{const o=e[a],i=n.ZP.extractDate(a,"MMMM_DD_YYYY").getTime();var c=0;for(const[e,n]of Object.entries(o))s[e]===t&&(c+=n);r.push([i,c])})),o.push({name:t,data:r})})),o}_calculateViewsByDayOfWeekAndGrouping(e,t,s){const a=Object.keys(e),o={};return Object.keys(t).forEach((e=>{o[e]={name:e,data:[0,0,0,0,0,0,0]}})),a.forEach((t=>{const a=n.ZP.extractDate(t,"MMMM_DD_YYYY").getDay(),r=e[t];for(const[e,n]of Object.entries(r)){const t=s[e];o[t].data[a]+=n}})),Object.values(o)}_calculateViewsByGrouping(e,t,s){const a={};Object.keys(t).forEach((e=>{a[e]=0}));for(const[n,o]of Object.entries(e))for(const[e,t]of Object.entries(o)){const n=s[e];a[n]+=t}return a}_calculateTotalViewsAndSubscribersByChannel(e,t,s){const a=s.map((e=>e.id)),n=Object.keys(e),o={},r={};a.forEach((e=>{o[e]=[],r[e]=[]}));const i={};s.forEach((e=>{i[e.id]=e})),n.forEach((s=>{Object.entries(e[s]).forEach((e=>{o[e[0]].push(e[1])})),Object.entries(t[s]).forEach((e=>{r[e[0]].push(e[1])}))}));const c=[];return Object.keys(o).forEach((e=>{const t=o[e],s=r[e],a=t.reduce(((e,t)=>e+t),0),n=s.reduce(((e,t)=>e+t),0);if(n>0){const t={name:i[e]["name"],id:parseInt(e),data:[[n,a]]};c.push(t)}})),c.sort(((e,t)=>t.data[0][0]<e.data[0][0]?-1:t.data[0][0]>e.data[0][0]?1:0)),c}_calculateViewsByDayAndChannel(e,t){const s=Object.keys(e),a=Object.values(t).flat(),o=[];a.forEach((t=>{const a=[];s.forEach((s=>{const o=e[s],r=n.ZP.extractDate(s,"MMMM_DD_YYYY").getTime();o.hasOwnProperty(t.id)?a.push([r,o[t.id]]):a.push([r,0])}));const r=a.reduce(((e,t)=>t[1]+e),0);o.push({name:t.name,data:a,totalViews:r})}));const r=o.reduce(((e,t)=>t.totalViews+e),0),i=o.map((e=>(e["percentageOfTotalViews"]=e.totalViews/r,e)));return i}_calculateViewsByChannelAndCollectByGrouping(e,t,s){const a={};for(const[o,r]of Object.entries(t))r.forEach((e=>{a[e.id]=0}));for(const[o,r]of Object.entries(e))for(const[e,t]of Object.entries(r))a[e]+=t;const n=[];for(const[o,r]of Object.entries(t)){const e=[];r.forEach((t=>{e.push({x:t.name,y:a[t.id],url:t.url,id:t.id,shareOfGrouping:(100*a[t.id]/s[o]).toFixed(1)})})),n.push({name:o,data:e})}return n}_getChannelIdToGroupingMap(e){const t={};for(const[s,a]of Object.entries(e))a.forEach((e=>{t[e.id]=s}));return t}saveCustomChannelGroupings(e){const t=Object.keys(e);t.forEach((t=>{0==e[t].length&&delete e[t]})),a.Z.set("customChannelGroupings",e)}getCustomChannelGroupings(){return a.Z.getItem("customChannelGroupings")}async getChannels(){const e=await r().get("./data/metadata.json");return Promise.resolve(Object.values(e.data["channels"]))}async getDefaultChannelGroupings(){const e=await r().get("./data/default-channel-groupings.json");return Promise.resolve(e.data)}async getChannelGroupings(){var e=await this.getDefaultChannelGroupings(),t=this.getCustomChannelGroupings();if(null===t)return Promise.resolve(e);const s=Object.values(t).flat().map((e=>e.id)),a=Object.values(e).flat().map((e=>e.id));if(s.length==a.length)return Promise.resolve(t);const n=a.filter((e=>!s.includes(e))),o=i.unngroupedGroupingName;t.hasOwnProperty(o)||(t[o]=[]);const r=Object.values(e).flat(),c=r.filter((e=>n.includes(e.id)));t[o]=t[o].concat(c);const l=Object.keys(t);return l.forEach((e=>{0==t[e].length&&delete t[e]})),this.saveCustomChannelGroupings(t),Promise.resolve(t)}}},3473:(e,t,s)=>{s.r(t),s.d(t,{default:()=>le});var a=s(3673),n=s(2323);const o={class:"col-xs-12 col-sm-12 col-md-3"},r={class:"row justify-center"},i={class:"row justify-center"},c={class:"col-xs-12 col-sm-12 col-md-9"},l={class:"row q-mt-md text-h5"},u={class:"row q-col-gutter-md q-mt-md q-mr-md q-ml-md"},d={class:"col-xs-12 col-sm-12 col-md-6 col-lg-6"},p={class:"col-xs-12 col-sm-12 col-md-6 col-lg-6"},h={class:"col-xs-12 col-sm-12 col-md-6 col-lg-6"},m={class:"col-xs-12 col-sm-12 col-md-6 col-lg-6"},f={class:"col-xs-12 col-sm-12 col-md-6 col-lg-6"},y={class:"col-xs-12 col-sm-12 col-md-6 col-lg-6"};function g(e,t,s,g,w,b){const D=(0,a.up)("ReportPeriodSelector"),v=(0,a.up)("q-btn"),Y=(0,a.up)("ChartOfShareByGrouping"),C=(0,a.up)("q-card"),M=(0,a.up)("ChartOfViewsByDayAndGrouping"),O=(0,a.up)("ChartOfViewsByDayOfWeekAndGrouping"),x=(0,a.up)("ChartOfShareByGroupingAndChannel"),B=(0,a.up)("ChartOfViewsByDayAndChannel"),G=(0,a.up)("ChartOfViewsAndSubscribersByChannel"),j=(0,a.up)("q-page");return(0,a.wg)(),(0,a.j4)(j,{class:"row"},{default:(0,a.w5)((()=>[(0,a.Wm)("div",o,[(0,a.Wm)("div",r,[(0,a.Wm)(D,{from:g.dateRange.from,to:g.dateRange.to,onReportRequested:g.handleReportRequested},null,8,["from","to","onReportRequested"])]),(0,a.Wm)("div",i,[(0,a.Wm)(v,{type:"a",href:"/#/ChannelGroupings",label:"Customize Groupings",push:""})])]),(0,a.Wm)("div",c,[(0,a.Wm)("div",l," Youtube Statistics for "+(0,n.zw)(g.dateRange.from)+" to "+(0,n.zw)(g.dateRange.to),1),(0,a.Wm)("div",u,[(0,a.Wm)("div",d,[(0,a.Wm)(C,{class:"fit q-pl-sm q-pr-sm q-pt-sm"},{default:(0,a.w5)((()=>[(0,a.Wm)(Y,{"raw-series":g.shareByGroupingData},null,8,["raw-series"])])),_:1})]),(0,a.Wm)("div",p,[(0,a.Wm)(C,{class:"fit q-pl-sm q-pr-sm q-pt-sm"},{default:(0,a.w5)((()=>[(0,a.Wm)(M,{series:g.viewsByDayAndGroupingData},null,8,["series"])])),_:1})]),(0,a.Wm)("div",h,[(0,a.Wm)(C,{class:"q-pl-sm q-pr-sm q-pt-sm"},{default:(0,a.w5)((()=>[(0,a.Wm)(O,{series:g.viewsByDayOfWeekAndGroupingData},null,8,["series"])])),_:1})]),(0,a.Wm)("div",m,[(0,a.Wm)(C,{class:"q-pl-sm q-pr-sm q-pt-sm"},{default:(0,a.w5)((()=>[(0,a.Wm)(x,{series:g.viewsByChannelCollectedByGroupingData},null,8,["series"])])),_:1})]),(0,a.Wm)("div",f,[(0,a.Wm)(C,{class:"q-pl-sm q-pr-sm q-pt-sm"},{default:(0,a.w5)((()=>[(0,a.Wm)(B,{series:g.viewsByDayAndChannelData},null,8,["series"])])),_:1})]),(0,a.Wm)("div",y,[(0,a.Wm)(C,{class:"q-pl-sm q-pr-sm q-pt-sm"},{default:(0,a.w5)((()=>[(0,a.Wm)(G,{series:g.viewsAndSubscribersByChannelData},null,8,["series"])])),_:1})])])])])),_:1})}s(7098);var w=s(1959),b=s(9582),D=s(2661);const v=(0,a.Wm)("div",{class:"text-h6"},"Select Report Period",-1);function Y(e,t,s,n,o,r){const i=(0,a.up)("q-card-section"),c=(0,a.up)("q-separator"),l=(0,a.up)("q-date"),u=(0,a.up)("q-card");return(0,a.wg)(),(0,a.j4)(u,{class:"no-box-shadow"},{default:(0,a.w5)((()=>[(0,a.Wm)(i,null,{default:(0,a.w5)((()=>[v])),_:1}),(0,a.Wm)(c,{dark:""}),(0,a.Wm)(i,null,{default:(0,a.w5)((()=>[(0,a.Wm)(l,{modelValue:n.dateRange,"onUpdate:modelValue":t[1]||(t[1]=e=>n.dateRange=e),minimal:"",range:"",onRangeEnd:n.reportRequested},null,8,["modelValue","onRangeEnd"])])),_:1})])),_:1})}const C={props:{from:{required:!0,type:String},to:{required:!0,type:String}},emits:["reportRequested"],setup(e,{emit:t}){const s=(0,w.iH)({from:e.from,to:e.to}),a=e=>{t("reportRequested",s.value)};return{reportRequested:a,dateRange:s}}};var M=s(151),O=s(5589),x=s(5869),B=s(6950),G=s(7518),j=s.n(G);C.render=Y;const W=C;j()(C,"components",{QCard:M.Z,QCardSection:O.Z,QSeparator:x.Z,QDate:B.Z});var _=s(3308);const q=(0,a.Wm)("div",{class:"text-h6"},"Share by Grouping and Channel",-1);function S(e,t,s,n,o,r){const i=(0,a.up)("apexchart");return(0,a.wg)(),(0,a.j4)("div",null,[q,(0,a.Wm)(i,{type:"treemap",series:s.series,options:n.options,onDataPointSelection:n.dataPointSelection,onMouseMove:n.asdf},null,8,["series","options","onDataPointSelection","onMouseMove"])])}var A=s(2585),P=s.n(A);const V={components:{apexchart:P()},props:{series:{required:!0,type:Object}},setup(e){const t=(0,b.tv)(),s={type:"treemap",tooltip:{fixed:{enabled:!0,position:"bottomLeft"},followCursor:!1,custom:function({series:t,seriesIndex:s,dataPointIndex:a,w:n}){const o=e.series[s].data[a];return'<div style="text-align: center; padding: 4px;"><img src="./channel-icons/'+o.id+'.jpg" width="100"><br>'+o.shareOfGrouping+"%</div>"}}},a=(s,a,n)=>{console.log("dataPointSelection",n);const{seriesIndex:o,dataPointIndex:r}=n;console.log(o,r),console.log(e.series),console.log(e.series[o].data[r]),t.push("/")},n=(e,t,s)=>{var a=t.el.querySelector(".apexcharts-tooltip");if(a){var n=e.offsetX,o=e.offsetY;e.offsetX<200?n+=70:n-=150,a.style.top=o+"px",a.style.left=n+"px"}console.log(e.offsetX,e.offsetY)};return{options:s,dataPointSelection:a,asdf:n}}};V.render=S;const k=V,Z=(0,a.Wm)("div",{class:"text-h6"},"Views by Day and Channel (Top 20)",-1);function E(e,t,s,n,o,r){const i=(0,a.up)("apexchart");return(0,a.wg)(),(0,a.j4)("div",null,[Z,(0,a.Wm)(i,{type:"line",series:s.series,options:n.options},null,8,["series","options"])])}const R={components:{apexchart:P()},props:{series:{required:!0,type:Object}},setup(e){const t={chart:{stacked:!1,toolbar:{show:!0},zoom:{enabled:!0}},xaxis:{type:"datetime"},dataLabels:{enabled:!1},stroke:{width:2},tooltip:{enabled:!1}};return{options:t}}};R.render=E;const T=R,F=(0,a.Wm)("div",{class:"text-h6"},"Views by Day of Week and Grouping",-1);function H(e,t,s,n,o,r){const i=(0,a.up)("apexchart");return(0,a.wg)(),(0,a.j4)("div",null,[F,(0,a.Wm)(i,{type:"bar",options:n.options,series:s.series},null,8,["options","series"])])}const I={components:{apexchart:P()},props:{series:{required:!0,type:Object}},setup(e){const t={chart:{type:"bar",stacked:!0,toolbar:{show:!0},zoom:{enabled:!1}},xaxis:{categories:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]}};return{options:t}}};I.render=H;const z=I,Q=(0,a.Wm)("div",{class:"text-h6"},"Views by Day and Grouping",-1);function L(e,t,s,n,o,r){const i=(0,a.up)("apexchart");return(0,a.wg)(),(0,a.j4)("div",null,[Q,(0,a.Wm)(i,{type:"area",series:s.series,options:n.options},null,8,["series","options"])])}const N={components:{apexchart:P()},props:{series:{required:!0,type:Object}},setup(e){const t={chart:{stacked:!0,toolbar:{show:!0},zoom:{enabled:!1}},xaxis:{type:"datetime"},dataLabels:{enabled:!1}};return{options:t}}};N.render=L;const X=N,U=(0,a.Wm)("div",{class:"text-h6"},"Share by Grouping",-1);function J(e,t,s,n,o,r){const i=(0,a.up)("apexchart");return(0,a.wg)(),(0,a.j4)("div",null,[U,(0,a.Wm)(i,{type:"donut",options:n.options,series:n.series},null,8,["options","series"])])}const K={components:{apexchart:P()},props:{rawSeries:{required:!0,type:Object}},setup(e){console.log(Object.keys(e.rawSeries)),console.log(Object.values(e.rawSeries));const t=(0,a.Fl)((()=>Object.values(e.rawSeries))),s=(0,a.Fl)((()=>({legend:{position:"bottom"},labels:Object.keys(e.rawSeries)})));return{options:s,series:t}}};K.render=J;const $=K,ee=(0,a.Wm)("div",{class:"text-h6"},"Views by Subscribers (top 25 by views or subscribers)",-1);function te(e,t,s,n,o,r){const i=(0,a.up)("apexchart");return(0,a.wg)(),(0,a.j4)("div",null,[ee,(0,a.Wm)(i,{type:"scatter",series:s.series,options:n.options},null,8,["series","options"])])}const se={components:{apexchart:P()},props:{series:{required:!0,type:Object}},setup(e){const t={chart:{toolbar:{show:!0},zoom:{enabled:!0}},dataLabels:{enabled:!1},tooltip:{enabled:!0}};return{options:t}}};se.render=te;const ae=se,{subtractFromDate:ne,formatDate:oe}=D.ZP,re={components:{ReportPeriodSelector:W,ChartOfShareByGroupingAndChannel:k,ChartOfViewsByDayAndChannel:T,ChartOfViewsByDayOfWeekAndGrouping:z,ChartOfViewsByDayAndGrouping:X,ChartOfShareByGrouping:$,ChartOfViewsAndSubscribersByChannel:ae},setup(){(0,b.tv)();const e=new Date,t=ne(e,{days:7}),s=oe(e,"MMM DD, YYYY"),a=oe(t,"MMM DD, YYYY"),n=(0,w.iH)({from:a,to:s}),o=new _.Z,r=(0,w.iH)([]),i=(0,w.iH)([]),c=(0,w.iH)([]),l=(0,w.iH)([]),u=(0,w.iH)([]),d=(0,w.iH)([]),p=e=>{r.value=e.viewsByGrouping,i.value=e.viewsByDayAndGrouping,c.value=e.viewsByDayOfWeekAndGrouping,l.value=e.viewsByChannelCollectedByGrouping;const t=e.viewsByDayAndChannel.sort(((e,t)=>t.percentageOfTotalViews-e.percentageOfTotalViews)),s=t.slice(0,20);u.value=s;const a=e.viewsAndSubscribersTotals.sort(((e,t)=>{e.data[0][0],t.data[0][0]})),n=e.viewsAndSubscribersTotals.sort(((e,t)=>{e.data[0][1],t.data[0][1]})),o=a.slice(0,25).map((e=>e.id)),p=n.slice(0,25).map((e=>e.id)),h=o.concat(p),m=e.viewsAndSubscribersTotals.filter((e=>h.includes(e.id)));d.value=m},h=e=>{n.value.from=oe(e.from,"MMM DD, YYYY"),n.value.to=oe(e.to,"MMM DD, YYYY"),o.fetchData(e.from,e.to).then((e=>{p(e)}))};return o.fetchData(oe(t,"YYYY/MM/DD"),oe(e,"YYYY/MM/DD")).then((e=>{p(e)})),{dateRange:n,handleReportRequested:h,shareByGroupingData:r,viewsByDayAndGroupingData:i,viewsByDayOfWeekAndGroupingData:c,viewsByChannelCollectedByGroupingData:l,viewsByDayAndChannelData:u,viewsAndSubscribersByChannelData:d}}};var ie=s(4379),ce=s(6281);re.render=g;const le=re;j()(re,"components",{QPage:ie.Z,QBtn:ce.Z,QCard:M.Z})}}]);