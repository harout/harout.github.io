"use strict";(self["webpackChunkyt_stats_quasar"]=self["webpackChunkyt_stats_quasar"]||[]).push([[289],{3308:(e,t,a)=>{a.d(t,{Z:()=>i});a(71),a(9377),a(7664);var s=a(6395),n=a(2661),o=a(52),r=a.n(o);class i{constructor(){}static get unngroupedGroupingName(){return"[Ungrouped]"}async _fetchViewsData(e,t){const a=n.ZP.extractDate(e,"YYYY/MM/DD"),s=n.ZP.extractDate(t,"YYYY/MM/DD");await this.getChannels();var o=await r().get("./data/metadata.json");const i=o.data,l=i["viewDeltaFiles"],c={},u=[],d={inclusiveFrom:!0,inclusiveTo:!0};l.forEach((e=>{const t=n.ZP.extractDate(e["start"],"MMMM_DD_YYYY"),o=n.ZP.extractDate(e["end"],"MMMM_DD_YYYY");(n.ZP.isBetweenDates(a,t,o,d)||n.ZP.isBetweenDates(s,t,o,d))&&u.push(r().get("./data/"+e["fileName"]))}));const p=await Promise.all(u);return p.forEach((e=>{Object.keys(e.data).forEach((t=>{const o=n.ZP.extractDate(t,"MMMM_DD_YYYY");n.ZP.isBetweenDates(o,a,s,d)&&(c[t]=e.data[t])}))})),c}async fetchData(e,t){const a=await this._fetchViewsData(e,t),s=await this.getChannelGroupings(),n=this._getChannelIdToGroupingMap(s),o=this._calculateViewsByGrouping(a,s,n),r=this._calculateViewsByDayAndGrouping(a,s,n),i=this._calculateViewsByDayOfWeekAndGrouping(a,s,n),l=this._calculateViewsByChannelAndCollectByGrouping(a,s,o),c=this._calculateViewsByDayAndChannel(a,s),u={viewsByGrouping:o,viewsByDayAndGrouping:r,viewsByDayOfWeekAndGrouping:i,viewsByChannelCollectedByGrouping:l,viewsByDayAndChannel:c};return Promise.resolve(u)}_calculateViewsByDayAndGrouping(e,t,a){const s=Object.keys(e),o=[];return Object.keys(t).forEach((t=>{const r=[];s.forEach((s=>{const o=e[s],i=n.ZP.extractDate(s,"MMMM_D_YYYY").getTime();var l=0;for(const[e,n]of Object.entries(o))a[e]===t&&(l+=n);r.push([i,l])})),o.push({name:t,data:r})})),o}_calculateViewsByDayOfWeekAndGrouping(e,t,a){const s=Object.keys(e),o={};return Object.keys(t).forEach((e=>{o[e]={name:e,data:[0,0,0,0,0,0,0]}})),s.forEach((t=>{const s=n.ZP.extractDate(t,"MMMM_D_YYYY").getDay(),r=e[t];for(const[e,n]of Object.entries(r)){const t=a[e];o[t].data[s]+=n}})),Object.values(o)}_calculateViewsByGrouping(e,t,a){const s={};Object.keys(t).forEach((e=>{s[e]=0}));for(const[n,o]of Object.entries(e))for(const[e,t]of Object.entries(o)){const n=a[e];s[n]+=t}return s}_calculateViewsByDayAndChannel(e,t){const a=Object.keys(e),s=Object.values(t).flat(),o=[];s.forEach((t=>{const s=[];a.forEach((a=>{const o=e[a],r=n.ZP.extractDate(a,"MMMM_D_YYYY").getTime();o.hasOwnProperty(t.id)?s.push([r,o[t.id]]):s.push([r,0])}));const r=s.reduce(((e,t)=>t[1]+e),0);o.push({name:t.name,data:s,totalViews:r})}));const r=o.reduce(((e,t)=>t.totalViews+e),0),i=o.map((e=>(e["percentageOfTotlaViews"]=e.totalViews/r,e)));return i}_calculateViewsByChannelAndCollectByGrouping(e,t,a){const s={};for(const[o,r]of Object.entries(t))r.forEach((e=>{s[e.id]=0}));for(const[o,r]of Object.entries(e))for(const[e,t]of Object.entries(r))s[e]+=t;const n=[];for(const[o,r]of Object.entries(t)){const e=[];r.forEach((t=>{e.push({x:t.name,y:s[t.id],url:t.url,id:t.id,shareOfGrouping:(100*s[t.id]/a[o]).toFixed(1)})})),n.push({name:o,data:e})}return n}_getChannelIdToGroupingMap(e){const t={};for(const[a,s]of Object.entries(e))s.forEach((e=>{t[e.id]=a}));return t}saveCustomChannelGroupings(e){const t=Object.keys(e);t.forEach((t=>{0==e[t].length&&delete e[t]})),s.Z.set("customChannelGroupings",e)}getCustomChannelGroupings(){return s.Z.getItem("customChannelGroupings")}async getChannels(){const e=await r().get("./data/metadata.json");return Promise.resolve(Object.values(e.data["channels"]))}async getDefaultChannelGroupings(){const e=await r().get("./data/default-channel-groupings.json");return Promise.resolve(e.data)}async getChannelGroupings(){var e=await this.getDefaultChannelGroupings(),t=this.getCustomChannelGroupings();if(null===t)return Promise.resolve(e);const a=Object.values(t).flat().map((e=>e.id)),s=Object.values(e).flat().map((e=>e.id));if(a.length==s.length)return Promise.resolve(t);const n=s.filter((e=>!a.includes(e))),o=i.unngroupedGroupingName;t.hasOwnProperty(o)||(t[o]=[]);const r=Object.values(e).flat(),l=r.filter((e=>n.includes(e.id)));t[o]=t[o].concat(l);const c=Object.keys(t);return c.forEach((e=>{0==t[e].length&&delete t[e]})),this.saveCustomChannelGroupings(t),Promise.resolve(t)}}},9289:(e,t,a)=>{a.r(t),a.d(t,{default:()=>H});var s=a(3673),n=a(2323);const o={class:"col-xs-12 col-sm-12 col-md-3"},r={class:"row justify-center"},i={class:"row justify-center"},l={class:"col-xs-12 col-sm-12 col-md-9"},c={class:"row q-mt-md text-h5"},u={class:"row q-col-gutter-md q-mt-md q-mr-md q-ml-md"},d={class:"col-xs-12 col-sm-12 col-md-6 col-lg-6"},p=(0,s.Wm)("div",{class:"text-h6"},"Share by Grouping",-1),m={class:"col-xs-12 col-sm-12 col-md-6 col-lg-6"},y=(0,s.Wm)("div",{class:"text-h6"},"Views by Day and Grouping",-1),g={class:"col-xs-12 col-sm-12 col-md-6 col-lg-6"},h=(0,s.Wm)("div",{class:"text-h6"},"Views by Day of Week and Grouping",-1),f={class:"col-xs-12 col-sm-12 col-md-6 col-lg-6"},v=(0,s.Wm)("div",{class:"text-h6"},"Share by Grouping and Channel",-1),w={class:"col-xs-12 col-sm-12 col-md-6 col-lg-6"},D=(0,s.Wm)("div",{class:"text-h6"},"Views by Day and Channel (Top 20)",-1);function B(e,t,a,B,G,b){const Y=(0,s.up)("ReportPeriodSelector"),O=(0,s.up)("q-btn"),C=(0,s.up)("apexchart"),W=(0,s.up)("q-card"),M=(0,s.up)("q-page");return(0,s.wg)(),(0,s.j4)(M,{class:"row"},{default:(0,s.w5)((()=>[(0,s.Wm)("div",o,[(0,s.Wm)("div",r,[(0,s.Wm)(Y,{from:B.dateRange.from,to:B.dateRange.to,onReportRequested:B.handleReportRequested},null,8,["from","to","onReportRequested"])]),(0,s.Wm)("div",i,[(0,s.Wm)(O,{type:"a",href:"/#/ChannelGroupings",label:"Customize Groupings",push:""})])]),(0,s.Wm)("div",l,[(0,s.Wm)("div",c," Youtube Statistics for "+(0,n.zw)(B.dateRange.from)+" to "+(0,n.zw)(B.dateRange.to),1),(0,s.Wm)("div",u,[(0,s.Wm)("div",d,[(0,s.Wm)(W,{class:"fit q-pl-sm q-pr-sm q-pt-sm"},{default:(0,s.w5)((()=>[(0,s.Wm)("div",null,[p,(0,s.Wm)(C,{type:"donut",options:B.shareByGroupingOptions,series:B.shareByGroupingSeries},null,8,["options","series"])])])),_:1})]),(0,s.Wm)("div",m,[(0,s.Wm)(W,{class:"fit q-pl-sm q-pr-sm q-pt-sm"},{default:(0,s.w5)((()=>[(0,s.Wm)("div",null,[y,(0,s.Wm)(C,{type:"area",series:B.viewsByDayAndGroupingData,options:B.viewsByDayAndGroupingOptions},null,8,["series","options"])])])),_:1})]),(0,s.Wm)("div",g,[(0,s.Wm)(W,{class:"q-pl-sm q-pr-sm q-pt-sm"},{default:(0,s.w5)((()=>[(0,s.Wm)("div",null,[h,(0,s.Wm)(C,{type:"bar",options:B.viewsByDayOfWeekAndGroupingOptions,series:B.viewsByDayOfWeekAndGroupingData},null,8,["options","series"])])])),_:1})]),(0,s.Wm)("div",f,[(0,s.Wm)(W,{class:"q-pl-sm q-pr-sm q-pt-sm"},{default:(0,s.w5)((()=>[(0,s.Wm)("div",null,[v,(0,s.Wm)(C,{type:"treemap",series:B.viewsByChannelCollectedByGroupingData,options:B.viewsByChannelCollectedByGroupingOptions},null,8,["series","options"])])])),_:1})]),(0,s.Wm)("div",w,[(0,s.Wm)(W,{class:"q-pl-sm q-pr-sm q-pt-sm"},{default:(0,s.w5)((()=>[(0,s.Wm)("div",null,[D,(0,s.Wm)(C,{type:"line",series:B.viewsByDayAndChannelData,options:B.viewsByDayAndChannelOptions},null,8,["series","options"])])])),_:1})])])])])),_:1})}a(7098);var G=a(1959),b=a(2661);const Y=(0,s.Wm)("div",{class:"text-h6"},"Select Report Period",-1);function O(e,t,a,n,o,r){const i=(0,s.up)("q-card-section"),l=(0,s.up)("q-separator"),c=(0,s.up)("q-date"),u=(0,s.up)("q-card");return(0,s.wg)(),(0,s.j4)(u,{class:"no-box-shadow"},{default:(0,s.w5)((()=>[(0,s.Wm)(i,null,{default:(0,s.w5)((()=>[Y])),_:1}),(0,s.Wm)(l,{dark:""}),(0,s.Wm)(i,null,{default:(0,s.w5)((()=>[(0,s.Wm)(c,{modelValue:n.dateRange,"onUpdate:modelValue":t[1]||(t[1]=e=>n.dateRange=e),minimal:"",range:"",onRangeEnd:n.reportRequested},null,8,["modelValue","onRangeEnd"])])),_:1})])),_:1})}const C={props:{from:{required:!0,type:String},to:{required:!0,type:String}},emits:["reportRequested"],setup(e,{emit:t}){const a=(0,G.iH)({from:e.from,to:e.to}),s=e=>{t("reportRequested",a.value)};return{reportRequested:s,dateRange:a}}};var W=a(151),M=a(5589),q=a(5869),_=a(6950),x=a(7518),j=a.n(x);C.render=O;const k=C;j()(C,"components",{QCard:W.Z,QCardSection:M.Z,QSeparator:q.Z,QDate:_.Z});var A=a(2585),P=a.n(A),V=a(3308);const{subtractFromDate:R,formatDate:Z}=b.ZP,E={components:{ReportPeriodSelector:k,apexchart:P()},setup(){const e=new Date,t=R(e,{days:7}),a=Z(e,"MMM DD, YYYY"),s=Z(t,"MMM DD, YYYY"),n=(0,G.iH)({from:s,to:a}),o=new V.Z,r=(0,G.iH)({legend:{placement:"bottom"}}),i=(0,G.iH)([]),l=(0,G.iH)([]),c={chart:{stacked:!0,toolbar:{show:!0},zoom:{enabled:!1}},xaxis:{type:"datetime"},dataLabels:{enabled:!1}},u=(0,G.iH)([]),d={chart:{type:"bar",stacked:!0,toolbar:{show:!0},zoom:{enabled:!1}},xaxis:{categories:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]}},p=(0,G.iH)([]),m=(0,G.iH)({type:"treemap",tooltip:{followCursor:!0,custom:function({series:e,seriesIndex:t,dataPointIndex:a,w:s}){const n=p.value[t].data[a];return'<div style="text-align: center; padding: 4px;"><img src="./channel-icons/'+n.id+'.jpg" width="100"><br>'+n.shareOfGrouping+"%</div>"}}}),y=(0,G.iH)([]),g={chart:{stacked:!1,toolbar:{show:!0},zoom:{enabled:!0}},xaxis:{type:"datetime"},dataLabels:{enabled:!1},stroke:{width:2},tooltip:{enabled:!1}},h=e=>{n.value.from=Z(e.from,"MMM DD, YYYY"),n.value.to=Z(e.to,"MMM DD, YYYY"),o.fetchData(e.from,e.to).then((e=>{r.value={labels:Object.keys(e.viewsByGrouping),legend:{position:"bottom"}},i.value=Object.values(e.viewsByGrouping),l.value=e.viewsByDayAndGrouping,u.value=e.viewsByDayOfWeekAndGrouping,p.value=e.viewsByChannelCollectedByGrouping;const t=e.viewsByDayAndChannel.sort(((e,t)=>t.percentageOfTotlaViews-e.percentageOfTotlaViews)),a=t.slice(0,20);y.value=a}))};return o.fetchData(Z(t,"YYYY/MM/DD"),Z(e,"YYYY/MM/DD")).then((e=>{r.value={labels:Object.keys(e.viewsByGrouping),legend:{position:"bottom"}},i.value=Object.values(e.viewsByGrouping),l.value=e.viewsByDayAndGrouping,u.value=e.viewsByDayOfWeekAndGrouping,p.value=e.viewsByChannelCollectedByGrouping;const t=e.viewsByDayAndChannel.sort(((e,t)=>t.percentageOfTotlaViews-e.percentageOfTotlaViews)),a=t.slice(0,20);y.value=a})),{dateRange:n,handleReportRequested:h,shareByGroupingOptions:r,shareByGroupingSeries:i,viewsByDayAndGroupingData:l,viewsByDayAndGroupingOptions:c,viewsByDayOfWeekAndGroupingOptions:d,viewsByDayOfWeekAndGroupingData:u,viewsByChannelCollectedByGroupingData:p,viewsByChannelCollectedByGroupingOptions:m,viewsByDayAndChannelData:y,viewsByDayAndChannelOptions:g}}};var S=a(4379),T=a(6281);E.render=B;const H=E;j()(E,"components",{QPage:S.Z,QBtn:T.Z,QCard:W.Z})}}]);